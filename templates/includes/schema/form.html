<!DOCTYPE html>

<!-- Customer -->

<!-- ko with: customer -->
<div class="row ">
  <div class="col-xs-12">
    <h2 class="justified">
      <span class="pointer" data-bind="text: address1() ? address1 : 'Kunde', click: function(){$('#customer_form_collapse').collapse('toggle')}"></span>
    </h2>
  </div>
</div>

<div class="row hidden" data-bind="css: {hidden: loading() || id() >= -1}">
  <div class="bs-callout bs-callout-primary">
    <h4>Ingen Kunde valgt.</h4>
    <p class="help-block">Bruk menyen
      <span class="visible-xs-inline">( øverst til venstre )</span>
      for å velge kunder opprettet i ditt firma, eller lag en ny kunde ved å bruke knappen øverst til høyrse.</p>
  </div>
</div>

<div data-bind="if: id() >= -1">
  <div id="customer_form_collapse" class="col-xs-12 collapse">
    <div class="row">
      <div class="well col-xs-12">
        <form id="customer_form">
          <button type="button" class="close close-dark pull-right" aria-label="Close" data-bind="click: function(d,e){$(e.target).closest('.collapse').collapse('hide')}">
            <span aria-hidden="true">&times;</span>
          </button>
          <!-- <legend>Kundeinformasjon</legend> -->
          <div class="fieldset">
            {{ render_field(customerForm.address.address1, 'form-group, col-xs-12', **{'data-bind':" value: address1, typeahead: autocompleteAddress, templateName: 'suggestion-template', displayKey: 'street_name', onSelectFunction: suggestionOnSelect "}) }}
            {{ render_field(customerForm.address.address2,
      'form-group, col-xs-12', no_label=True, **{'data-bind':" textInput: address2 "}) }}
            {{ render_field(customerForm.address.post_code, 'form-group col-xs-4 col-sm-2 zero-pad-r', **{'data-bind':" textInput: post_code"}) }}
            {{ render_field(customerForm.address.post_area,'form-group
      col-xs-8 col-sm-10 zero-pad-l' , **{'data-bind': "textInput: post_area", 'readonly':'readonly'}) }}

          </div>

        </form>
        <div class="text-right">
          <div class="btn-group nowra">
            <button
              type="button"
              class="btn btn-primary"
              data-bind="
        click: function(x,e){post(x,e).done(function(){$(e.target).closest('.collapse').collapse('hide')})},
        css: {opaque: !validationModel.isValid() || !modified()},
        enable: modified() && validationModel.isValid(),
        text: id() >= 0 ? 'Endre' : 'Lagre'"
              data-loading-text="<span class='glyphicon glyphicon-refresh spinning'></span>"></button>
            <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="caret"></span>
              <span class="sr-only">Vis dropdown-meny</span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right">
              <li>
                <a href="#" data-bind="
        click: function() {comfirm_dialog('Slette kunde?', 'Er du sikker på at du vil slette denne kunden?', modified() || sub_modified()? 'Du har ulagrede elementer her': undefined, this.delete)}">
                  <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                  Slett kunde</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Room -->
  <div class="row">
    <div class="col-xs-12">
      <!-- ko if: rooms -->
      <h3 class="justified hidden">
        Rom/stedsinformasjon
        <!-- ko if: id() >= 0 -->
        <button type="button" class="btn btn-sm btn-primary pull-right" data-bind="click: rooms().add">
          <span class="glyphicon glyphicon-plus"></span>
          Legg til rom</button>
        <!-- /ko -->
      </h3>
      <!-- ko if: rooms().list().length == 0  -->
      <div class=" bs-callout bs-callout-info">
        <h3>Ingen rom lagt til</h3>
        <span>Du kan legge til et rom for denne adressen fra nedtrekksmenyen ovenfor.</span>
      </div>
      <!-- /ko -->
      <!-- /ko -->
      <div class="col-xs 12">
        <!-- ko with: rooms -->
        <!-- ko if: selected() === null -->
        <p class="help-block">Velg et rom i listen
          <span class="visible-xs-inline">fra menyen.</span>
          <span class="hidden-xs">til venstre</span>
        </p>
        <!-- /ko -->
        <!-- ko with: list()[selected()] -->
        {% include 'includes/schema/room_accordian.html' %}
        <!-- /ko -->
        <!-- /ko -->
      </div>
      <!-- /ko -->
    </div>
  </div>
</div>
<!-- /ko -->
