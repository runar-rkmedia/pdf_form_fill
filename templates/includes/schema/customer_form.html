<!DOCTYPE html>

<!-- Customer -->

<!-- ko with: customer -->
<div class="row ">
  <div class="col-xs-12">
    <h2 class="justified">
      <span class="pointer" data-bind="text: address1() ? address1 : 'Kunde', click: function(){$('#customer_form_collapse').collapse('toggle')}"></span>
    </h2>
  </div>
</div>

<div class="row hidden" data-bind="css: {hidden: loading() || id() >= -1}">
  <div class="bs-callout bs-callout-primary">
    <h4>Ingen Kunde valgt.</h4>
    <p class="help-block">Bruk menyen
      <span class="visible-xs-inline">( øverst til venstre )</span>
      for å velge kunder opprettet i ditt firma, eller lag en ny kunde ved å bruke knappen øverst til høyrse.</p>
  </div>
</div>

<div data-bind="if: id() >= -1">
  <div id="customer_form_collapse" class="col-xs-12 collapse">
    <div class="row">
      <div class="well col-xs-12">
        <button type="button" class="close close-dark pull-right" aria-label="Close" data-bind="click: function(d,e){$(e.target).closest('.collapse').collapse('hide')}">
          <span aria-hidden="true">&times;</span>
        </button>
        <div class="[ form-group ]">
          <input type="checkbox" name="corporate_customer_check" id="corporate_customer_check" autocomplete="off"/>
          <div class="[ form-group ]">
            <input type="checkbox" id="corporate_customer_check_" autocomplete="off" data-bind="checked: corporate_customer"/>
            <div class="[ btn-group ]">
              <label class="[ btn btn-default active ]" for="corporate_customer_check_">
                Bedriftskunde
              </label>
              <label class="[ btn btn-info ]" for="corporate_customer_check_">
                <span class="[ glyphicon glyphicon-ok ]"></span>
                <span></span>
              </label>
            </div>
          </div>
        </div>
        <!-- ko if: corporate_customer -->
        <!-- ko with: company -->
        <div class="form-group">
          <label for="#company-search">
            Søk etter et firma her, for å få raske opplysninger.
          </label>
          <div class="input-group">
            <input
              type="text"
              class="form-control"
              placeholder="f.eks. Petter Strømmen AS"
              data-bind=" value: search, typeahead: autocompleteBRreg, templateName: 'brregsuggestion-template', displayKey: 'adresse', onSelectFunction: suggestionOnSelect, remoteFilter:
          brreg_remote_filter, typeaheadOpts:{minLength:2}">
            <span class="input-group-addon glyphicon glyphicon-search" aria-hidden="true"></span>
          </div>
        </div>
        <!-- /ko -->
        <!-- /ko -->

        <!-- <legend>Kundeinformasjon</legend> -->
        <div class="fieldset">
          <!-- ko if: extra_info -->
          {{ render_field(customerForm.customer_name, **{'placeholder':   'Ola Nordmann', 'data-bind': 'textInput: name' }) }}
          <!-- /ko -->
          {{ render_field(customerForm.address.address1, 'form-group', **{'data-bind':" value: address1, typeahead: autocompleteAddress, templateName: 'suggestion-template', displayKey: 'street_name', onSelectFunction: suggestionOnSelect "}) }}
          {{ render_field(customerForm.address.address2,
      'form-group', no_label=True, **{'data-bind':" textInput: address2 "}) }}
          {{ render_field(customerForm.address.post_code, 'form-group col-xs-4 col-sm-2 zero-pad-r', **{'data-bind':" textInput: post_code"}) }}
          {{ render_field(customerForm.address.post_area,'form-group
        col-xs-8 col-sm-10 zero-pad-l' , **{'data-bind': "textInput: post_area", 'readonly':'readonly'}) }}
          <!-- ko if: corporate_customer -->
          {{ render_field(customerForm.org_nr, **{'data-bind':" valueWithInit: company.orgnumber", 'placeholder': '123456789'}) }}
          <!-- /ko -->
          <!-- ko if: extra_info -->
          {{ render_field(customerForm.contact_name, **{'placeholder':   'Ola Nordmann'}) }}
          {{ render_field(customerForm.phone, **{'placeholder':   '12345678, 00471234567890', 'pattern': '\d{8}|00[\d]{3,20}'})}}
          {{ render_field(customerForm.mobile, **{'placeholder':   '12345678, 00471234567890', 'pattern': '\d{8}|00[\d]{3,20}'})}}
          <!-- /ko -->

        </div>

        <div class="text-right">
          <div class="btn-group nowra">
            <button
              type="button"
              class="btn btn-primary"
              data-bind="
        click: function(x,e){post(x,e).done(function(){$(e.target).closest('.collapse').collapse('hide')})},
        css: {opaque: !validationModel.isValid() || !modified()},
        enable: modified() && validationModel.isValid(),
        text: id() >= 0 ? 'Endre' : 'Lagre'"
              data-loading-text="<span class='glyphicon glyphicon-refresh spinning'></span>"></button>
            <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="caret"></span>
              <span class="sr-only">Vis dropdown-meny</span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right">
              <li>
                <a href="#" data-bind="
        click: function() {comfirm_dialog('Slette kunde?', 'Er du sikker på at du vil slette denne kunden?', modified() || sub_modified()? 'Du har ulagrede elementer her': undefined, this.delete)}">
                  <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                  Slett kunde</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Room -->
  <div class="row">
    <div class="col-xs-12">
      <!-- ko if: rooms -->
      <h3 class="justified hidden">
        Rom/stedsinformasjon
        <!-- ko if: id() >= 0 -->
        <button type="button" class="btn btn-sm btn-primary pull-right" data-bind="click: rooms().add">
          <span class="glyphicon glyphicon-plus"></span>
          Legg til rom</button>
        <!-- /ko -->
      </h3>
      <!-- ko if: rooms().list().length == 0  -->
      <div class=" bs-callout bs-callout-info">
        <h3>Ingen rom lagt til</h3>
        <span class="help-block">Du kan legge til et rom fra menyen ovenfor ( knappen helt øverst til venstre )</span>
      </div>
      <!-- /ko -->
      <!-- /ko -->
      <div class="col-xs 12">
        <!-- ko with: rooms -->
        <!-- ko if: selected() === null -->
        <p class="help-block">Velg et rom i listen
          <span class="visible-xs-inline">fra menyen.</span>
          <span class="hidden-xs">til venstre</span>
        </p>
        <!-- /ko -->
        <!-- ko with: list()[selected()] -->
        {% include 'includes/schema/room_accordian.html' %}
        <!-- /ko -->
        <!-- /ko -->
      </div>
      <!-- /ko -->
    </div>
  </div>
</div>
<!-- /ko -->
